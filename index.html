<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <!-- SEO & Social Sharing -->
    <title>Yihan Zhang's Story World</title>
    <meta name="description"
        content="Portfolio of Yihan Zhang, a Researcher and Designer at UNC Chapel Hill. Current focus: Pluggy Ecosystem, 26Fall PhD Applications.">
    <meta name="keywords" content="Yihan Zhang, UNC, HCI, Design Engineering, Portfolio, Pluggy, 26Fall">
    <meta name="author" content="Yihan Zhang">
    <link rel="icon" href="UNC_Logo.png" type="image/png">
    <meta name="theme-color" content="#ffffff">

    <!-- Open Graph / Facebook / LinkedIn -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://zhayihan.unc.edu/">
    <meta property="og:title" content="Yihan Zhang - UNC Researcher & Designer">
    <meta property="og:description"
        content="Bridging Industrial Hardware, Full-Stack Prototyping, and Behavioral Data Science.">
    <meta property="og:image" content="UNC_Logo.png">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://zhayihan.unc.edu/">
    <meta property="twitter:title" content="Yihan Zhang - UNC Researcher & Designer">
    <meta property="twitter:description"
        content="Bridging Industrial Hardware, Full-Stack Prototyping, and Behavioral Data Science.">
    <meta property="twitter:image" content="UNC_Logo.png">

    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        unc: {
                            DEFAULT: '#4B9CD3', // Carolina Blue
                            light: '#7BAFD4',
                            dark: '#13294B'
                        },
                        moma: {
                            red: '#E4002B', // MoMA/Art Red
                            black: '#000000',
                            white: '#FFFFFF'
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        serif: ['Playfair Display', 'serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    animation: {
                        'blob': 'blob 12s infinite ease-in-out',
                        'fade-in': 'fadeIn 0.5s ease-out forwards',
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        }
                    }
                }
            }
        }
    </script>

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Framer Motion -->
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>

    <!-- Preload Hero Image -->
    <link rel="preload" as="image" href="Yihan.png">

    <!-- Marked for Markdown -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:ital,wght@0,400;0,500;0,600;0,700;1,400;1,600&family=JetBrains+Mono:wght@400&display=swap"
        rel="stylesheet">

    <style>
        /* Base Styles */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #ffffff;
            color: #111;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            transition: background-color 0.3s ease, color 0.3s ease;
            cursor: none;
            /* Hide default cursor for custom implementation */
        }

        /* Restore default cursor on touch devices */
        @media (pointer: coarse) {
            body {
                cursor: auto;
            }

            .custom-cursor-container {
                display: none !important;
            }
        }

        .dark body {
            background-color: #0f172a;
            color: #f8fafc;
        }

        h1,
        h2,
        h3,
        h4,
        .serif {
            font-family: 'Playfair Display', serif;
        }

        .mono {
            font-family: 'JetBrains Mono', monospace;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: #d1d5db;
            border-radius: 3px;
        }

        .dark ::-webkit-scrollbar-thumb {
            background: #475569;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #9ca3af;
        }

        /* PDF Viewer Styling */
        .pdf-frame {
            width: 100%;
            height: 100%;
            border: none;
            display: block;
        }

        /* Image Placeholder */
        .img-placeholder {
            background-color: #f8fafc;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #94a3b8;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            text-align: center;
            border: 1px solid #e2e8f0;
            transition: all 0.4s ease;
            width: 100%;
            height: 100%;
            min-height: 240px;
        }

        .dark .img-placeholder {
            background-color: #1e293b;
            border-color: #334155;
            color: #64748b;
        }

        /* Animated Blobs */
        @keyframes blob {
            0% {
                transform: translate(0px, 0px) scale(1);
            }

            33% {
                transform: translate(30px, -50px) scale(1.1);
            }

            66% {
                transform: translate(-20px, 20px) scale(0.9);
            }

            100% {
                transform: translate(0px, 0px) scale(1);
            }
        }

        .animate-blob {
            animation: blob 12s infinite ease-in-out;
        }

        .animation-delay-2000 {
            animation-delay: 2s;
        }

        /* Mobile Menu Backdrop */
        .mobile-menu-backdrop {
            background-color: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(16px);
        }

        /* No Scrollbar Utility */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>

<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo, useCallback, useLayoutEffect } = React;
        const { motion, AnimatePresence, useScroll, useSpring, useMotionValue, useTransform } = window.Motion;

        // --- ENHANCED CUSTOM CURSOR (Trail duration changed to 500ms) ---
        const CustomCursor = () => {
            const cursorRef = useRef(null);
            const pathRef = useRef(null);
            const pointsRef = useRef([]);

            const [isHovering, setIsHovering] = useState(false);
            const [isClicking, setIsClicking] = useState(false);

            useEffect(() => {
                const onMouseDown = () => setIsClicking(true);
                const onMouseUp = () => setIsClicking(false);
                const onMouseOver = (e) => {
                    if (e.target.tagName === 'BUTTON' || e.target.tagName === 'A' ||
                        e.target.closest('button') || e.target.closest('a') ||
                        e.target.closest('.cursor-pointer') || e.target.tagName === 'INPUT') {
                        setIsHovering(true);
                    } else {
                        setIsHovering(false);
                    }
                };

                window.addEventListener('mousedown', onMouseDown);
                window.addEventListener('mouseup', onMouseUp);
                window.addEventListener('mouseover', onMouseOver);

                let animationFrameId;
                const renderLoop = () => {
                    const now = Date.now();
                    if (pointsRef.current.length > 0) {
                        // Trail retains for 500ms
                        pointsRef.current = pointsRef.current.filter(p => now - p.t < 500);
                    }
                    if (pathRef.current) {
                        if (pointsRef.current.length > 1) {
                            const head = pointsRef.current[pointsRef.current.length - 1];
                            let d = `M ${head.x} ${head.y}`;
                            for (let i = pointsRef.current.length - 2; i >= 0; i--) {
                                const p = pointsRef.current[i];
                                d += ` L ${p.x} ${p.y}`;
                            }
                            pathRef.current.setAttribute('d', d);
                        } else {
                            pathRef.current.setAttribute('d', '');
                        }
                    }
                    animationFrameId = requestAnimationFrame(renderLoop);
                };
                animationFrameId = requestAnimationFrame(renderLoop);

                const onMouseMove = (e) => {
                    const { clientX, clientY } = e;
                    if (cursorRef.current) {
                        cursorRef.current.style.transform = `translate3d(${clientX}px, ${clientY}px, 0)`;
                    }
                    pointsRef.current.push({ x: clientX, y: clientY, t: Date.now() });
                };

                window.addEventListener('mousemove', onMouseMove);

                return () => {
                    window.removeEventListener('mousedown', onMouseDown);
                    window.removeEventListener('mouseup', onMouseUp);
                    window.removeEventListener('mouseover', onMouseOver);
                    window.removeEventListener('mousemove', onMouseMove);
                    cancelAnimationFrame(animationFrameId);
                };
            }, [isHovering, isClicking]);

            return (
                <div className="custom-cursor-container pointer-events-none fixed inset-0 z-[9999] overflow-hidden">
                    <svg className="absolute inset-0 w-full h-full pointer-events-none">
                        <path ref={pathRef} fill="none" stroke="#4B9CD3" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" style={{ opacity: 0.6 }} />
                    </svg>
                    <div ref={cursorRef} className="fixed top-0 left-0 pointer-events-none will-change-transform" style={{ left: 0, top: 0 }}>
                        <div className="w-4 h-4 bg-unc rounded-full mix-blend-difference" style={{ transform: `translate(-50%, -50%) scale(${isClicking ? 0.8 : (isHovering ? 2.0 : 1)})`, transition: 'transform 0.15s cubic-bezier(0.2, 0, 0.13, 1.5)' }} />
                    </div>
                </div>
            );
        };

        // --- UTILITIES ---
        const ScrollProgress = () => {
            const { scrollYProgress } = useScroll();
            const scaleX = useSpring(scrollYProgress, { stiffness: 100, damping: 30, restDelta: 0.001 });
            return <motion.div className="fixed top-0 left-0 right-0 h-1 bg-unc origin-left z-[60]" style={{ scaleX }} />;
        };

        const Toast = ({ message, isVisible, onClose }) => (
            <AnimatePresence>
                {isVisible && (
                    <motion.div initial={{ opacity: 0, y: 50, x: '-50%' }} animate={{ opacity: 1, y: 0, x: '-50%' }} exit={{ opacity: 0, y: 20, x: '-50%' }} className="fixed bottom-8 left-1/2 transform -translate-x-1/2 z-[110] bg-black dark:bg-white text-white dark:text-black px-6 py-3 rounded-full shadow-2xl flex items-center gap-3">
                        <i data-lucide="check-circle" className="w-5 h-5 text-green-500"></i><span className="font-medium text-sm">{message}</span>
                    </motion.div>
                )}
            </AnimatePresence>
        );

        // --- PERFORMANCE UTILITIES ---
        // Hook to load scripts dynamically
        const useScript = (src) => {
            const [status, setStatus] = useState(src ? "loading" : "idle");
            useEffect(() => {
                if (!src) { setStatus("idle"); return; }
                let script = document.querySelector(`script[src="${src}"]`);
                if (!script) {
                    script = document.createElement("script");
                    script.src = src;
                    script.async = true;
                    script.setAttribute("data-status", "loading");
                    document.body.appendChild(script);
                    const setAttributeFromEvent = (event) => {
                        script.setAttribute("data-status", event.type === "load" ? "ready" : "error");
                        setStatus(event.type === "load" ? "ready" : "error");
                    };
                    script.addEventListener("load", setAttributeFromEvent);
                    script.addEventListener("error", setAttributeFromEvent);
                } else {
                    setStatus(script.getAttribute("data-status"));
                }
                const setStateFromEvent = (event) => setStatus(event.type === "load" ? "ready" : "error");
                script.addEventListener("load", setStateFromEvent);
                script.addEventListener("error", setStateFromEvent);
                return () => {
                    if (script) {
                        script.removeEventListener("load", setStateFromEvent);
                        script.removeEventListener("error", setStateFromEvent);
                    }
                };
            }, [src]);
            return status;
        };

        // Component to defer rendering until visible or after initial load
        const DeferredSection = ({ children }) => {
            const [shouldRender, setShouldRender] = useState(false);
            const ref = useRef(null);

            useEffect(() => {
                // Simple timeout to defer non-critical sections slightly
                const timer = setTimeout(() => setShouldRender(true), 100);
                return () => clearTimeout(timer);
            }, []);

            if (!shouldRender) return <div ref={ref} className="min-h-[200px]" />; // Placeholder
            return <>{children}</>;
        };

        // --- ANIMATION VARIANTS ---
        const pageVariants = {
            initial: { opacity: 0, y: 10 },
            animate: { opacity: 1, y: 0 },
            exit: { opacity: 0, y: -10 },
            transition: { duration: 0.4, ease: [0.22, 1, 0.36, 1] }
        };

        // --- DATA ---
        const NAV_ITEMS = [{ id: 'home', label: 'Overview' }, { id: 'now', label: 'Now' }, { id: 'news', label: 'News' }, { id: 'research', label: 'Research' }, { id: 'projects', label: 'Artifacts' }, { id: 'unc', label: 'Campus' }, { id: 'art', label: 'Gallery' }, { id: 'contact', label: 'Contact' }];
        const NEWS_DATA = [
            { date: "May 2025", title: "Selected Exhibitor", subtitle: "UNC Smart Design Showcase", desc: "Showcased 'Chill by U' laptop stand prototype to engineering faculty.", id: 'news-01' },
            { date: "Spring 2025", title: "Academic Excellence", subtitle: "UNC Chapel Hill", desc: "Achieved 4.00 GPA with maximum course load (18 credits), demonstrating resilience and academic rigor.", id: 'news-02' },
            { date: "2024", title: "Award Winner", subtitle: "UNC MakerFest", desc: "Won 2nd Most Creative Prize for innovative hardware design.", id: 'news-03' },
            { date: "2022", title: "Competition Winner", subtitle: "Sustainable Campus Design", desc: "3rd Prize in 'Let's Charrette' competition for urban sustainability concepts.", id: 'news-04' }
        ];
        const WORKS_DATA = [
            { id: 'PRJ-01', title: 'Offline Oracle', cat: 'HCI & Health Intervention', filterType: 'HARDWARE', status: 'Proto v2.0', year: '2025', desc: 'A hybrid physical-digital framework addressing digital addiction via tangible rewards.', tech: ['Arduino IoT', 'React Native', '3D Printing'], role: 'Lead Researcher', link: 'Offline_Oracle.html', img: 'Offline_Oracle.png' },
            { id: 'PRJ-02', title: 'TEMPEST Autonomous Vessel', cat: 'Robotics & Perception', filterType: 'HARDWARE', status: 'Field Tested', year: '2023', desc: 'Low-cost autonomous surface vessel (ASV) for urban waterway monitoring.', tech: ['ROS / Python', 'Lidar Sensing', 'Motor Control'], role: 'System Architect', link: 'TEMPEST_Autonomous_Vessel.html', img: 'TEMPEST_Robot.png' },
            { id: 'PRJ-03', title: 'SmartCan Intelligent Sorting', cat: 'Behavioral Design', filterType: 'SOFTWARE', status: 'Deployed', year: '2024', desc: 'Computer-vision assisted waste disposal system with real-time object recognition.', tech: ['TensorFlow', 'Embedded C++', 'Servo Mechanics'], role: 'Interaction Designer', link: 'SmartCan_Intelligent_Sorting.html', img: 'SmartCan.png' },
            { id: 'PRJ-04', title: 'Chill by "U"', cat: 'Fabrication & Thermal Eng', filterType: 'HARDWARE', status: 'Awarded', year: '2024', desc: 'Modular laptop cooling infrastructure with adaptive airflow.', tech: ['Laser Cutting', 'Fusion 360'], role: 'Solo Inventor', link: 'Chill_by_U.html', img: 'Chill_by_U.png' },
            { id: 'PRJ-05', title: 'Ecological IoT Feeder', cat: 'Ecological Sensing', filterType: 'HARDWARE', status: 'Operational', year: '2023', desc: 'Automated avian monitoring system using weight/light sensors.', tech: ['IoT Sensors', 'Data Logging'], role: 'Hardware Eng', link: 'Ecological_IoT_Feeder.html', img: 'Smart_Bird_Feeder.png' },
            { id: 'PRJ-06', title: 'Spatial Inequality Analysis', cat: 'Data Science (GIS)', filterType: 'DATA_SCI', status: 'Published', year: '2022', desc: 'Quantitative geospatial analysis of US Population Change & Global Coffee Trade.', tech: ['R / RStudio', 'ArcGIS Pro'], role: 'Data Analyst', link: 'Spatial_Inequality_Analysis.html', img: 'GIS_Map.png' },
            { id: 'PRJ-07', title: 'Pluggy Ecosystem', cat: 'Hardware & Business', filterType: 'HARDWARE', status: 'Proposal', year: '2025', desc: 'The World\'s First 30W Gamified Charger for Digital Detox.', tech: ['GaN Hardware', 'IoT', 'Gamification'], role: 'Co-Founder', link: 'Pluggy.html', img: 'Pluggy.png' },
            { id: 'PRJ-08', title: 'Agri-Drone HMI', cat: 'HMI & Systems Design', filterType: 'UI_DESIGN', status: 'Concept v3', year: '2025', desc: 'HMI for managing autonomous agricultural drone swarms with gaze-tracking.', tech: ['Adobe XD', 'WebGazer API'], role: 'UX Researcher', link: 'Agri-Drone_HMI.html', img: 'Drone_HMI.png' },
            { id: 'PRJ-09', title: 'Health Dashboard', cat: 'UI/UX & MedTech', filterType: 'UI_DESIGN', status: 'Ongoing', year: '2025', desc: 'Health Informatics APP for remote patient monitoring.', tech: ['Figma', 'Health Informatics'], role: 'UX Designer', link: 'Health_Dashboard.html', img: 'Health_Informatics.png' }
        ];
        const ART_DATA = [
            { id: 'art-01', title: "Altered Landscape", medium: "Digital Photography, 2024", img: "Altered_Landscape_I.jpg", aspect: "aspect-[3/2]", colSpan: "md:col-span-8" },
            { id: 'art-02', title: "Layered Transparency", medium: "Graphite on Paper", img: "Layered_Transparency.png", aspect: "aspect-[3/4]", colSpan: "md:col-span-4" },
            { id: 'art-03', title: "Structure 8", medium: "Charcoal Study", img: "Structure_8.png", aspect: "aspect-square", colSpan: "md:col-span-4" },
            { id: 'art-04', title: "Apple Study", medium: "Graphite & Ink, 18x24\"", img: "Apple_Study.png", aspect: "aspect-[16/9]", colSpan: "md:col-span-8" },
            { id: 'art-05', title: "Cultural Stitch", medium: "Graphite on Paper", img: "Cultural Stitch.png", aspect: "aspect-[3/4]", colSpan: "md:col-span-4" },
            { id: 'art-06', title: "Emotional Encounter", medium: "Fanart - Pencil", img: "Conan_Fanart.png", aspect: "aspect-[3/4]", colSpan: "md:col-span-4" },
            { id: 'art-07', title: "Crumpled Silence", medium: "Graphite - Texture Study", img: "Crumpled_Silence.png", aspect: "aspect-[3/4]", colSpan: "md:col-span-4" },
            { id: 'art-08', title: "Visual Anthology", medium: "Selected Works Compilation, 2022-2025", img: "", aspect: "aspect-[21/9]", colSpan: "md:col-span-12", isPlaceholder: true }
        ];

        // --- COMPONENTS ---

        // 1. Search Modal
        const SearchModal = ({ isOpen, onClose, sections, activeSection, setActiveSection }) => {
            const [query, setQuery] = useState('');
            const inputRef = useRef(null);

            useEffect(() => {
                if (isOpen) setTimeout(() => inputRef.current?.focus(), 100);
            }, [isOpen]);

            const filteredItems = useMemo(() => {
                if (!query) return [];
                const lowerQ = query.toLowerCase();
                const results = [];
                sections.forEach(sec => { if (sec.label.toLowerCase().includes(lowerQ)) results.push({ type: 'Navigate', label: sec.label, id: sec.id, icon: 'map-pin' }); });
                WORKS_DATA.forEach(work => { if (work.title.toLowerCase().includes(lowerQ) || work.desc.toLowerCase().includes(lowerQ)) results.push({ type: 'Project', label: work.title, id: 'projects', sub: work.cat, icon: 'folder' }); });
                return results;
            }, [query, sections]);

            if (!isOpen) return null;

            return (
                <div className="fixed inset-0 z-[100] flex items-start justify-center pt-24 px-4">
                    <div className="absolute inset-0 bg-black/20 dark:bg-black/60 backdrop-blur-sm" onClick={onClose}></div>
                    <motion.div
                        initial={{ opacity: 0, scale: 0.95 }}
                        animate={{ opacity: 1, scale: 1 }}
                        className="relative w-full max-w-lg bg-white dark:bg-gray-900 rounded-xl shadow-2xl overflow-hidden border border-gray-200 dark:border-gray-700 flex flex-col max-h-[60vh]"
                    >
                        <div className="flex items-center px-4 py-3 border-b border-gray-100 dark:border-gray-800">
                            <i data-lucide="search" className="w-5 h-5 text-gray-400"></i>
                            <input
                                ref={inputRef}
                                className="flex-1 bg-transparent border-none focus:ring-0 text-gray-900 dark:text-white placeholder-gray-400 ml-3 text-base outline-none"
                                placeholder="Search projects, research, or navigate..."
                                value={query}
                                onChange={e => setQuery(e.target.value)}
                                onKeyDown={e => { if (e.key === 'Escape') onClose(); }}
                            />
                            <button onClick={onClose} className="text-xs bg-gray-100 dark:bg-gray-800 text-gray-500 px-2 py-1 rounded cursor-pointer">ESC</button>
                        </div>
                        <div className="overflow-y-auto p-2">
                            {filteredItems.length === 0 && query !== '' && (
                                <div className="p-4 text-center text-sm text-gray-500">No results found.</div>
                            )}
                            {filteredItems.map((item, idx) => (
                                <button
                                    key={idx}
                                    onClick={() => { setActiveSection(item.id); onClose(); }}
                                    className="w-full text-left flex items-center gap-3 px-3 py-3 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg group transition-colors cursor-pointer"
                                >
                                    <div className="w-8 h-8 rounded-full bg-gray-100 dark:bg-gray-700 flex items-center justify-center text-gray-500 dark:text-gray-300 group-hover:bg-unc group-hover:text-white transition-colors">
                                        <i data-lucide={item.icon || 'arrow-right'} className="w-4 h-4"></i>
                                    </div>
                                    <div>
                                        <div className="text-sm font-medium text-gray-900 dark:text-white">{item.label}</div>
                                        {item.sub && <div className="text-xs text-gray-500 dark:text-gray-400">{item.type} â€¢ {item.sub}</div>}
                                    </div>
                                </button>
                            ))}
                        </div>
                    </motion.div>
                </div>
            );
        };

        const Navbar = ({ activeSection, setActiveSection, darkMode, toggleTheme, setSearchOpen }) => {
            const [mobileMenuOpen, setMobileMenuOpen] = useState(false);
            return (
                <nav className="fixed w-full z-50 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl border-b border-gray-100 dark:border-gray-800 transition-all duration-300 supports-[backdrop-filter]:bg-white/60">
                    <ScrollProgress />
                    <div className="max-w-7xl mx-auto px-6 lg:px-8">
                        <div className="flex justify-between items-center h-20">
                            <div className="flex items-center gap-3 group cursor-pointer" onClick={() => setActiveSection('home')}><span className="text-lg font-serif font-bold tracking-tight text-gray-900 dark:text-white group-hover:text-unc transition-colors">Yihan Zhang</span><span className="hidden sm:block h-4 w-px bg-gray-300 dark:bg-gray-700"></span><span className="hidden sm:block text-xs font-medium text-unc tracking-wide uppercase">UNC Chapel Hill</span></div>
                            <div className="hidden md:flex space-x-6 text-sm font-medium text-gray-500 dark:text-gray-400">{NAV_ITEMS.map((item) => (<button key={item.id} onClick={() => setActiveSection(item.id)} className={`nav-btn transition-colors hover:text-black dark:hover:text-white relative cursor-pointer ${activeSection === item.id ? 'text-black dark:text-white font-semibold' : ''}`}>{item.label}{activeSection === item.id && <motion.div layoutId="underline" className="absolute -bottom-1 left-0 right-0 h-0.5 bg-unc" />}</button>))}</div>
                            <div className="hidden md:flex items-center gap-3">
                                <div onClick={() => setSearchOpen(true)} className="group relative flex items-center gap-2 bg-gray-100 dark:bg-gray-800 px-3 py-1.5 rounded-full cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors border border-transparent hover:border-gray-300 dark:hover:border-gray-600 w-48">
                                    <i data-lucide="search" className="w-4 h-4 text-gray-500 dark:text-gray-400"></i>
                                    <span className="text-sm text-gray-400 dark:text-gray-500 font-normal">Search...</span>
                                    <div className="absolute right-2 flex items-center gap-1"><span className="text-[10px] font-mono text-gray-400 border border-gray-300 dark:border-gray-600 rounded px-1">âŒ˜K</span></div>
                                </div>
                                <button onClick={toggleTheme} className="p-2 text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full cursor-pointer"><i data-lucide={darkMode ? "sun" : "moon"} className="w-4 h-4"></i></button><div className="h-4 w-px bg-gray-200 dark:bg-gray-700 mx-1"></div><button onClick={() => setActiveSection('cv')} className="cursor-pointer flex items-center gap-2 text-xs font-medium text-gray-900 dark:text-gray-200 border border-gray-200 dark:border-gray-700 px-4 py-2 rounded-full hover:bg-gray-50 dark:hover:bg-gray-800 hover:border-unc/30 transition shadow-sm"><i data-lucide="file-text" className="w-3 h-3"></i> CV</button>
                            </div>
                            <div className="flex md:hidden items-center gap-4"><button onClick={toggleTheme} className="text-gray-600 dark:text-gray-300 cursor-pointer"><i data-lucide={darkMode ? "sun" : "moon"} className="w-5 h-5"></i></button><button className="p-2 text-gray-600 dark:text-gray-300 cursor-pointer" onClick={() => setMobileMenuOpen(!mobileMenuOpen)}><i data-lucide={mobileMenuOpen ? "x" : "menu"} className="w-6 h-6"></i></button></div>
                        </div>
                    </div>
                    <AnimatePresence>{mobileMenuOpen && (<motion.div initial={{ opacity: 0, y: -20 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: -20 }} className="fixed inset-0 z-40 pt-24 px-6 mobile-menu-backdrop dark:bg-gray-900/98 md:hidden flex flex-col h-screen"><div className="flex flex-col gap-6 text-center">{NAV_ITEMS.map((item) => (<button key={item.id} onClick={() => { setActiveSection(item.id); setMobileMenuOpen(false); }} className={`text-2xl font-serif cursor-pointer ${activeSection === item.id ? 'text-unc font-bold' : 'text-gray-800 dark:text-gray-200'}`}>{item.label}</button>))}</div></motion.div>)}</AnimatePresence>
                </nav>
            );
        };

        const Hero = ({ setActiveSection }) => {
            const [text, setText] = useState('');
            const fullText = "Idealist.";
            useEffect(() => {
                let index = 0;
                const timer = setInterval(() => { setText(fullText.slice(0, index)); index++; if (index > fullText.length) clearInterval(timer); }, 150);
                return () => clearInterval(timer);
            }, []);

            return (
                <section className="min-h-[90vh] flex items-center justify-center relative overflow-hidden pt-20 bg-white dark:bg-gray-900 transition-colors duration-300">
                    <div className="absolute top-0 left-1/4 w-[300px] md:w-[600px] h-[300px] md:h-[600px] bg-unc/5 dark:bg-unc/10 rounded-full mix-blend-multiply dark:mix-blend-normal filter blur-[80px] md:blur-[128px] opacity-70 animate-blob"></div>
                    <div className="absolute top-0 right-1/4 w-[250px] md:w-[500px] h-[250px] md:h-[500px] bg-blue-50 dark:bg-blue-900/20 rounded-full mix-blend-multiply dark:mix-blend-normal filter blur-[80px] md:blur-[128px] opacity-60 animate-blob animation-delay-2000"></div>
                    <div className="max-w-6xl mx-auto px-6 z-10 relative grid md:grid-cols-12 gap-12 md:gap-16 items-center">
                        <div className="md:col-span-7 text-center md:text-left">
                            <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.2 }} className="inline-flex items-center gap-2 px-3 py-1 rounded border border-unc/20 bg-unc/5 dark:bg-unc/10 mb-6 md:mb-8 mx-auto md:mx-0">
                                <span className="relative flex h-2 w-2"><span className="animate-ping absolute inline-flex h-full w-full rounded-full bg-unc opacity-75"></span><span className="relative inline-flex rounded-full h-2 w-2 bg-unc"></span></span>
                                <span className="text-[10px] font-bold text-unc-dark dark:text-unc-light uppercase tracking-widest">Open for PhD Opportunities Fall 2026</span>
                            </motion.div>
                            <motion.h1 initial={{ opacity: 0, y: 30 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.4 }} className="text-5xl md:text-8xl font-medium tracking-tighter mb-6 md:mb-8 leading-[1.1] text-gray-900 dark:text-white">The Pragmatic <br /><span className="serif italic text-unc">{text}<span className="animate-pulse">|</span></span></motion.h1>
                            <motion.p initial={{ opacity: 0, y: 30 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.6 }} className="text-base md:text-lg text-gray-600 dark:text-gray-300 max-w-xl mx-auto md:mx-0 leading-relaxed font-light mb-8">Bridging <strong>Industrial Hardware</strong>, <strong>Full-Stack Prototyping</strong>, and <strong>Behavioral Data Science</strong> to build Human-Centered Intelligent Systems.</motion.p>
                            <motion.div initial={{ opacity: 0, y: 30 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.8 }} className="flex flex-col sm:flex-row gap-4 justify-center md:justify-start">
                                <button onClick={() => setActiveSection('projects')} className="cursor-pointer px-8 py-3 text-sm font-medium text-white bg-black dark:bg-white dark:text-black rounded-full hover:bg-unc dark:hover:bg-unc dark:hover:text-white hover:scale-105 transition-all duration-300 shadow-xl w-full sm:w-auto">View Portfolio</button>
                                <a href="02_Research_Statement_Yihan_Zhang.pdf" target="_blank" className="cursor-pointer px-8 py-3 text-sm font-medium text-gray-900 dark:text-gray-200 bg-white dark:bg-transparent border border-gray-200 dark:border-gray-700 rounded-full hover:border-unc dark:hover:border-unc transition-all duration-300 w-full sm:w-auto flex items-center justify-center">Research Statement</a>
                            </motion.div>
                        </div>
                        <div className="md:col-span-5 relative hidden md:block">
                            <motion.div initial={{ opacity: 0, scale: 0.95 }} animate={{ opacity: 1, scale: 1 }} transition={{ delay: 0.5 }} className="aspect-[4/5] bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 p-3 rounded-sm shadow-2xl rotate-2 hover:rotate-0 transition-transform duration-700">
                                <div className="w-full h-full bg-gray-100 dark:bg-gray-900 flex flex-col items-center justify-center text-gray-400 font-mono text-xs space-y-2 relative overflow-hidden group">
                                    {/* Enhanced Fallback: Shows a framed Yihan text if image fails */}
                                    <img src="Yihan.png" alt="Yihan Zhang" className="w-full h-full object-cover object-top transition-transform duration-700 group-hover:scale-105" onError={(e) => { e.target.style.display = 'none'; e.target.parentElement.classList.add('img-placeholder'); e.target.parentElement.innerHTML = `<div class="w-full h-full flex flex-col items-center justify-center"><span class="text-4xl mb-2">ðŸŽ“</span><span class="font-serif text-lg text-gray-500">Yihan Zhang</span></div>`; }} />
                                    <div className="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                                </div>
                            </motion.div>
                        </div>
                    </div>
                </section>
            );
        };

        const Stats = () => (
            <div className="bg-white dark:bg-gray-900 border-t border-b border-gray-100 dark:border-gray-800 py-12 relative overflow-hidden transition-colors duration-300">
                <div className="absolute left-0 top-0 h-full w-1 bg-unc hidden md:block"></div>
                <div className="max-w-7xl mx-auto px-6 grid grid-cols-2 md:grid-cols-4 gap-8 md:gap-12 text-center">
                    {[{ val: "Chinese A Share", label: "Indus. R&D Context" }, { val: "2", label: "Granted Patents" }, { val: "4.0", label: "Recent Term GPA" }, { val: "Top 2", label: "UNC MakerFest" }].map((stat, i) => (
                        <motion.div key={i} initial={{ opacity: 0, y: 20 }} whileInView={{ opacity: 1, y: 0 }} viewport={{ once: true }} transition={{ delay: i * 0.1 }}>
                            <div className="text-2xl md:text-3xl font-serif font-bold text-gray-900 dark:text-white">{stat.val}</div>
                            <div className="text-[10px] md:text-xs text-gray-500 dark:text-gray-400 font-semibold uppercase tracking-widest mt-2 text-unc-dark dark:text-unc-light">{stat.label}</div>
                        </motion.div>
                    ))}
                </div>
            </div>
        );

        const NowPage = () => {
            const focusItems = [
                { title: "Pluggy Ecosystem", subtitle: "Hardware Founder", desc: "Building the world's first 30W Gamified Charger. Addressing digital wellbeing through physical constraints and a gamified 'Skin Economy'.", tags: ["Hardware", "Startup", "Gamification"], status: "In Development", icon: "zap" },
                { title: "PhD Applications", subtitle: "Fall 2026 Entry", desc: "Applying to PhD programs in HCI and Design Engineering. Research interest: Urban Micro-Interaction Systems & Behavioral Sensing.", tags: ["Academic", "Research", "Future"], status: "Drafting Statements", icon: "graduation-cap" },
                { title: "UNC Graduation", subtitle: "Senior Capstone", desc: "Completing final undergraduate requirements at UNC Chapel Hill. Integrating Information Science with Studio Art practice.", tags: ["Milestone", "SILS", "Art"], status: "Spring 2026", icon: "flag" }
            ];
            return (
                <section className="py-24 bg-gray-50 dark:bg-gray-900 min-h-screen transition-colors duration-300">
                    <div className="max-w-5xl mx-auto px-6">
                        <div className="flex flex-col md:flex-row justify-between items-end mb-16"><div><div className="flex items-center gap-2 mb-4"><span className="relative flex h-3 w-3"><span className="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span><span className="relative inline-flex rounded-full h-3 w-3 bg-green-500"></span></span><span className="text-xs font-bold uppercase tracking-widest text-gray-500 dark:text-gray-400">Current Focus / Now</span></div><h2 className="text-4xl md:text-6xl font-serif font-bold text-gray-900 dark:text-white">What I'm doing.</h2></div><div className="text-right hidden md:block"><p className="text-sm font-mono text-green-500">LAST_UPDATED: NOV 2025</p><p className="text-sm font-mono text-green-500">LOC: CHAPEL HILL, NC</p></div></div>
                        <div className="grid gap-8">
                            {focusItems.map((item, i) => (
                                <motion.div key={i} initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: i * 0.1 }} className="bg-white dark:bg-gray-800 rounded-2xl p-8 border border-gray-100 dark:border-gray-700 shadow-sm hover:shadow-md transition-all group relative overflow-hidden">
                                    <div className="absolute -right-6 -bottom-6 opacity-5 dark:opacity-10 transform group-hover:scale-110 transition-transform duration-500"><i data-lucide={item.icon} className="w-40 h-40"></i></div>
                                    <div className="flex flex-col md:flex-row gap-6 md:items-start relative z-10"><div className="w-12 h-12 rounded-full bg-gray-100 dark:bg-gray-700 flex items-center justify-center flex-shrink-0"><i data-lucide={item.icon} className="w-6 h-6 text-gray-900 dark:text-white"></i></div><div className="flex-1"><div className="flex flex-col md:flex-row md:justify-between md:items-center mb-2"><h3 className="text-2xl font-bold text-gray-900 dark:text-white group-hover:text-unc transition-colors">{item.title}</h3><span className="inline-block px-3 py-1 bg-gray-100 dark:bg-gray-900 rounded-full text-xs font-mono font-bold text-gray-500 dark:text-gray-400 mt-2 md:mt-0 w-fit">{item.status}</span></div><p className="text-sm font-bold text-gray-400 uppercase tracking-wide mb-4">{item.subtitle}</p><p className="text-gray-600 dark:text-gray-300 leading-relaxed text-lg mb-6 max-w-3xl">{item.desc}</p><div className="flex flex-wrap gap-2">{item.tags.map(tag => (<span key={tag} className="text-xs font-medium px-2 py-1 border border-gray-200 dark:border-gray-600 rounded text-gray-500 dark:text-gray-400">#{tag}</span>))}</div></div></div>
                                </motion.div>
                            ))}
                        </div>
                    </div>
                </section>
            );
        };

        const NewsSection = () => (
            <section className="py-16 md:py-24 bg-white dark:bg-gray-900 border-t border-gray-100 dark:border-gray-800 transition-colors duration-300">
                <div className="max-w-4xl mx-auto px-6">
                    <div className="flex items-baseline gap-4 mb-8 md:mb-12"><h2 className="text-xl md:text-2xl font-serif font-bold text-black dark:text-white">Academic Updates</h2><div className="h-px bg-gray-200 dark:bg-gray-700 flex-1"></div></div>
                    <div className="space-y-8 md:space-y-12 border-l border-gray-200 dark:border-gray-700 pl-6 md:pl-8 ml-2 md:ml-3">
                        {NEWS_DATA.map((item, i) => (
                            <div key={i} className="relative group">
                                <div className="absolute -left-[31px] md:-left-[39px] top-1.5 w-4 h-4 md:w-5 md:h-5 bg-white dark:bg-gray-800 border-2 border-gray-300 dark:border-gray-600 rounded-full group-hover:border-unc group-hover:scale-110 transition-all duration-300"></div>
                                <span className="text-[10px] md:text-xs font-mono text-unc mb-1 block uppercase tracking-wider font-bold">{item.date}</span>
                                <h3 className="text-base md:text-lg font-medium text-gray-900 dark:text-gray-100">{item.title} <span className="text-gray-400 dark:text-gray-500 font-light block md:inline">| {item.subtitle}</span></h3>
                                <p className="text-sm text-gray-600 dark:text-gray-400 mt-2 leading-relaxed">{item.desc}</p>
                            </div>
                        ))}
                    </div>
                </div>
            </section>
        );

        const Research = () => (
            <section className="py-24 bg-gray-50 dark:bg-gray-950 transition-colors duration-300">
                <div className="max-w-6xl mx-auto px-6">
                    <div className="mb-20">
                        <div className="flex items-baseline gap-4 mb-6"><h2 className="text-3xl md:text-4xl font-serif font-bold text-gray-900 dark:text-white">Research Framework</h2><div className="h-px bg-gray-300 dark:bg-gray-700 flex-1"></div></div>
                        <blockquote className="border-l-4 border-unc pl-6 mb-8 italic text-gray-500 dark:text-gray-400 text-lg">"Smartness serves functions; Wisdom serves people..."</blockquote>
                        <p className="text-lg md:text-xl text-gray-700 dark:text-gray-300 font-light leading-relaxed max-w-4xl"><strong>From Smart Cities to Wise Systems.</strong><br />I build <strong>Human-Centered IoT Systems</strong> that bridge the gap between digital sensing and human social behavior.</p>
                        <div className="flex flex-wrap gap-3 mt-8">
                            {['Behavioral Sensing', 'Human-Centered AI', 'Preventive Intervention', 'Social Nuance Understanding', 'Closed-Loop Feedback'].map(tag => (
                                <span key={tag} className="px-3 py-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-full text-xs font-mono text-gray-600 dark:text-gray-300 tracking-wide uppercase">
                                    {tag}
                                </span>
                            ))}
                        </div>
                    </div>

                    {/* Methodology Visual */}
                    <div className="mb-24">
                        <div className="flex justify-between items-end mb-4"><h3 className="text-sm font-bold text-gray-400 uppercase tracking-widest">Methodology Architecture</h3><span className="text-xs font-mono text-gray-400">Fig 1. Perception-Decision-Execution Loop</span></div>
                        <div className="w-full aspect-[21/9] md:aspect-[3/1] bg-gray-50 dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm flex flex-col justify-center items-center group hover:border-unc/30 transition-colors cursor-pointer overflow-hidden relative">
                            <img src="Framework_Diagram.jpg" alt="Methodology Diagram" className="w-full h-full object-contain dark:invert dark:hue-rotate-180" onError={(e) => { e.target.style.display = 'none'; }} />
                            <div className="absolute inset-0 flex flex-col items-center justify-center z-0">
                                <i data-lucide="workflow" className="w-10 h-10 mb-3 text-gray-300 dark:text-gray-600"></i>
                                <span className="text-sm text-gray-500 dark:text-gray-400">Framework_Diagram.jpg</span>
                                <span className="text-xs text-gray-400 mt-1">Place image in folder</span>
                            </div>
                        </div>
                    </div>

                    <div className="grid md:grid-cols-12 gap-16">
                        {/* Publications Column */}
                        <div className="md:col-span-7 space-y-12">
                            <div>
                                <div className="flex items-center gap-3 mb-8">
                                    <h3 className="text-xl font-serif font-bold text-gray-900 dark:text-white">Publications & Manuscripts</h3>
                                    <div className="h-px bg-gray-200 dark:bg-gray-700 flex-1"></div>
                                </div>
                                <ul className="space-y-8">
                                    <li className="group">
                                        <a href="07_Offline Oracle_ A Gamified Framework.pdf" target="_blank" className="block hover:bg-white dark:hover:bg-gray-900 hover:shadow-sm p-6 -mx-6 rounded-xl transition-all border border-transparent hover:border-gray-100 dark:hover:border-gray-800">
                                            <div className="flex justify-between items-start mb-3">
                                                <span className="text-[10px] font-bold text-unc bg-unc/10 px-2 py-1 rounded uppercase tracking-wider">Draft Paper</span>
                                                <span className="text-xs font-mono text-gray-400">2025</span>
                                            </div>
                                            <h4 className="text-xl font-medium text-gray-900 dark:text-gray-100 leading-tight group-hover:text-unc transition-colors">
                                                Offline Oracle: A Gamified Framework for Diagnosing "True Needs"
                                            </h4>
                                            <p className="text-sm text-gray-600 dark:text-gray-400 mt-3 font-light">
                                                <span className="font-medium text-black dark:text-white">Yihan Zhang</span>.
                                                <em>Targeting CHI / UbiComp.</em>
                                            </p>
                                            <p className="text-sm text-gray-500 dark:text-gray-400 mt-3 leading-relaxed line-clamp-2 group-hover:line-clamp-none transition-all">
                                                Proposes a hybrid physical-digital system to address digital addiction through tangible rewards and social bonding, validating the "True Needs" hypothesis.
                                            </p>
                                        </a>
                                    </li>

                                    <li className="group">
                                        <a href="03_Research-portfolio_Yihan.pdf" target="_blank" className="block hover:bg-white dark:hover:bg-gray-900 hover:shadow-sm p-6 -mx-6 rounded-xl transition-all border border-transparent hover:border-gray-100 dark:hover:border-gray-800">
                                            <div className="flex justify-between items-start mb-3">
                                                <span className="text-[10px] font-bold text-white bg-black dark:bg-white dark:text-black px-2 py-1 rounded uppercase tracking-wider">Published</span>
                                                <span className="text-xs font-mono text-gray-400">2022</span>
                                            </div>
                                            <h4 className="text-xl font-medium text-gray-900 dark:text-gray-100 leading-tight group-hover:text-unc transition-colors">
                                                Spatial Inequality Analysis: US Population Change & Global Coffee Trade
                                            </h4>
                                            <p className="text-sm text-gray-600 dark:text-gray-400 mt-3 font-light">
                                                <span className="font-medium text-black dark:text-white">Yihan Zhang</span>.
                                            </p>
                                            <p className="text-sm text-gray-500 dark:text-gray-400 mt-2 leading-relaxed">
                                                Quantitative geospatial analysis utilizing R and ArcGIS to map socioeconomic disparities.
                                            </p>
                                        </a>
                                    </li>

                                    <li className="group">
                                        <a href="02_Research_Statement_Yihan_Zhang.pdf" target="_blank" className="block hover:bg-white dark:hover:bg-gray-900 hover:shadow-sm p-6 -mx-6 rounded-xl transition-all border border-transparent hover:border-gray-100 dark:hover:border-gray-800">
                                            <div className="flex justify-between items-start mb-3">
                                                <span className="text-[10px] font-bold text-gray-600 dark:text-gray-300 bg-gray-200 dark:bg-gray-700 px-2 py-1 rounded uppercase tracking-wider">Statement</span>
                                                <span className="text-xs font-mono text-gray-400">2025</span>
                                            </div>
                                            <h4 className="text-xl font-medium text-gray-900 dark:text-gray-100 leading-tight group-hover:text-unc transition-colors">
                                                Research Statement: Intelligent Design Framework for Deployable Systems
                                            </h4>
                                            <p className="text-sm text-gray-600 dark:text-gray-400 mt-3 font-light">
                                                <span className="font-medium text-black dark:text-white">Yihan Zhang</span>.
                                                <em>University of North Carolina at Chapel Hill.</em>
                                            </p>
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>

                        {/* Patents Column - Removed sticky to ensure it scrolls naturally */}
                        <div className="md:col-span-5">
                            <div className="bg-[#111] dark:bg-black text-white p-8 rounded-xl shadow-2xl relative overflow-hidden border-t-4 border-unc">
                                <div className="absolute top-0 right-0 w-40 h-40 bg-gray-800 rounded-full mix-blend-screen filter blur-3xl opacity-20 pointer-events-none"></div>

                                <h3 className="text-xs font-bold uppercase tracking-widest mb-8 text-gray-400 flex items-center gap-2">
                                    <i data-lucide="award" className="w-4 h-4 text-unc"></i> Industrial Patents
                                </h3>

                                <div className="space-y-10 relative z-10">
                                    <div className="group">
                                        <div className="flex justify-between items-start mb-3">
                                            <span className="text-[10px] bg-white text-black px-2 py-0.5 rounded font-bold uppercase tracking-wider">First Inventor</span>
                                            <span className="text-xs font-mono text-gray-500 group-hover:text-white transition-colors">CN209791046U</span>
                                        </div>
                                        <h4 className="font-serif text-xl text-white leading-snug mb-3">Disc-Tube Reverse Osmosis Apparatus</h4>
                                        <p className="text-xs text-gray-400 font-light leading-relaxed border-l-2 border-gray-800 pl-4 group-hover:border-unc transition-colors">
                                            Solved a critical maintenance bottleneck for landfill leachate treatment via a novel detachable mesh design. Adopted by Weiming Group (Â¥40B).
                                        </p>
                                    </div>

                                    <div className="h-px bg-gray-800 w-full"></div>

                                    <div className="group">
                                        <div className="flex justify-between items-start mb-3">
                                            <span className="text-[10px] border border-gray-600 text-gray-400 px-2 py-0.5 rounded uppercase tracking-wider">2nd Inventor</span>
                                            <span className="text-xs font-mono text-gray-500 group-hover:text-white transition-colors">CN215209304U</span>
                                        </div>
                                        <h4 className="font-serif text-xl text-white leading-snug mb-3">Kitchen Waste Extraction Device</h4>
                                        <p className="text-xs text-gray-400 font-light leading-relaxed border-l-2 border-gray-800 pl-4 group-hover:border-unc transition-colors">
                                            Co-designed a multi-stage slag discharge system for complex waste processing machinery.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        );

        const Projects = () => {
            const [activeFilter, setActiveFilter] = useState('ALL');
            const filteredWorks = useMemo(() => { if (activeFilter === 'ALL') return WORKS_DATA; return WORKS_DATA.filter(work => work.filterType === activeFilter); }, [activeFilter]);

            return (
                <section className="py-24 bg-white dark:bg-gray-900 relative border-t border-gray-200 dark:border-gray-800 transition-colors duration-300">
                    <div className="max-w-7xl mx-auto px-6 relative z-10">
                        <div className="flex flex-col md:flex-row justify-between items-end mb-12 border-b-2 border-black dark:border-white pb-6">
                            <div>
                                <div className="flex items-center gap-2 text-black dark:text-white font-serif italic text-sm mb-2">
                                    <span className="w-2 h-2 bg-black dark:bg-white rounded-full"></span>
                                    Selected Works
                                </div>
                                <h2 className="text-4xl md:text-6xl font-serif font-bold text-black dark:text-white tracking-tight">
                                    Artifacts <span className="text-gray-400 font-light">&</span> Data
                                </h2>
                            </div>
                            <div className="mt-6 md:mt-0 text-right font-mono text-xs space-y-1 text-gray-600 dark:text-gray-400">
                                <p>ARCHIVE_ID: YZ-UNC-2025</p>
                                <p>STATUS: <span className="text-green-600 dark:text-green-400 font-bold">ONLINE</span></p>
                            </div>
                        </div>

                        <div className="flex flex-wrap gap-2 mb-12 pb-6 border-b border-gray-200 dark:border-gray-700 font-mono text-xs">
                            {[
                                { id: 'ALL', label: 'ALL_ENTRIES' },
                                { id: 'HARDWARE', label: 'HARDWARE_SYSTEMS' },
                                { id: 'SOFTWARE', label: 'SOFTWARE_COMPUTING' },
                                { id: 'UI_DESIGN', label: 'INTERFACE_DESIGN' },
                                { id: 'DATA_SCI', label: 'DATA_ANALYSIS' }
                            ].map((filter) => (
                                <button
                                    key={filter.id}
                                    onClick={() => setActiveFilter(filter.id)}
                                    className={`px-4 py-2 border transition-all duration-300 uppercase tracking-wider cursor-pointer ${activeFilter === filter.id
                                        ? 'bg-black text-white border-black shadow-lg dark:bg-white dark:text-black dark:border-white'
                                        : 'bg-white text-gray-500 border-gray-300 hover:border-black hover:text-black dark:bg-gray-900 dark:text-gray-400 dark:border-gray-700 dark:hover:border-white dark:hover:text-white'
                                        }`}
                                >
                                    {filter.label}
                                </button>
                            ))}
                        </div>

                        <AnimatePresence mode='wait'>
                            <motion.div
                                key={activeFilter}
                                initial={{ opacity: 0, y: 20 }}
                                animate={{ opacity: 1, y: 0 }}
                                exit={{ opacity: 0, y: -20 }}
                                transition={{ duration: 0.3, ease: "easeInOut" }}
                                className="grid md:grid-cols-2 gap-8 md:gap-12"
                            >
                                {filteredWorks.map((work) => (
                                    <motion.div
                                        key={work.id}
                                        className="group bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 hover:border-black dark:hover:border-white transition-all duration-500 flex flex-col h-full shadow-sm hover:shadow-2xl relative overflow-hidden"
                                    >
                                        <div className="absolute top-0 right-0 w-0 h-0 border-t-[40px] border-t-black dark:border-t-white border-l-[40px] border-l-transparent z-20"></div>
                                        <div className="bg-gray-100 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-5 py-3 flex justify-between items-center font-mono text-[10px] text-gray-600 dark:text-gray-400 uppercase tracking-wider">
                                            <span className="font-bold text-black dark:text-white">REF: {work.id}</span>
                                            <div className="flex gap-4 items-center">
                                                <span>{work.year}</span>
                                                <span className={`px-1.5 py-0.5 rounded text-[9px] font-bold border ${work.status.includes('Awarded') ? 'bg-yellow-100 border-yellow-400 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-200' : 'bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-black dark:text-white'}`}>
                                                    {work.status}
                                                </span>
                                            </div>
                                        </div>

                                        <a href={work.link} target="_blank" className="block relative aspect-[16/10] overflow-hidden border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 group-hover:opacity-100 cursor-pointer">
                                            <img
                                                src={work.img}
                                                alt={work.title}
                                                loading="lazy"
                                                className="w-full h-full object-cover filter grayscale contrast-125 group-hover:grayscale-0 group-hover:contrast-100 transition-all duration-700 ease-in-out group-hover:scale-105"
                                                onError={(e) => {
                                                    e.target.style.display = 'none';
                                                    e.target.parentElement.classList.add('img-placeholder');
                                                    e.target.parentElement.innerHTML = `<div class="text-center p-4 font-mono text-xs"><span class="block text-2xl mb-2">âš ï¸</span>DATA_MISSING<br/><span class="text-gray-400">${work.img}</span></div>`;
                                                }}
                                            />
                                            <div className="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/graphy.png')] opacity-10 pointer-events-none mix-blend-multiply dark:mix-blend-overlay"></div>
                                            <div className="absolute bottom-0 left-0 right-0 bg-black/90 backdrop-blur text-white px-6 py-3 text-xs font-mono uppercase translate-y-full group-hover:translate-y-0 transition-transform duration-300 flex justify-between items-center">
                                                <span>Access Full Documentation</span>
                                                <i data-lucide="arrow-right" className="w-3 h-3"></i>
                                            </div>
                                        </a>

                                        <div className="p-8 flex-grow flex flex-col relative">
                                            <div className="absolute top-4 right-4 text-6xl font-bold text-gray-100 dark:text-gray-800 font-serif pointer-events-none -z-0 select-none">
                                                {work.id.split('-')[1]}
                                            </div>
                                            <div className="mb-6 relative z-10">
                                                <span className="text-[10px] font-bold bg-black dark:bg-white text-white dark:text-black px-2 py-1 inline-block mb-3 font-mono uppercase tracking-widest">{work.cat}</span>
                                                <h3 className="text-3xl font-serif font-bold text-black dark:text-white leading-none group-hover:text-unc transition-colors mt-1">
                                                    {work.title}
                                                </h3>
                                            </div>
                                            <p className="text-sm text-gray-600 dark:text-gray-400 font-serif leading-relaxed mb-8 flex-grow relative z-10">
                                                {work.desc}
                                            </p>
                                            <div className="mt-auto border-t-2 border-gray-100 dark:border-gray-800 pt-4 relative z-10">
                                                <div className="grid grid-cols-3 gap-4 mb-4">
                                                    <div className="col-span-3">
                                                        <span className="text-[9px] font-bold uppercase tracking-widest text-gray-400 block mb-2">Technology Stack</span>
                                                        <div className="flex flex-wrap gap-1.5">
                                                            {work.tech.map((t, i) => (
                                                                <span key={i} className="px-1.5 py-0.5 bg-gray-100 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 text-[9px] font-mono text-gray-700 dark:text-gray-300">
                                                                    {t}
                                                                </span>
                                                            ))}
                                                        </div>
                                                    </div>
                                                </div>
                                                <div className="flex justify-between items-end border-t border-gray-100 dark:border-gray-800 pt-2">
                                                    <div>
                                                        <span className="text-[9px] font-mono text-gray-400 uppercase block">Primary Role</span>
                                                        <span className="text-xs font-bold text-black dark:text-white">{work.role}</span>
                                                    </div>
                                                    <i data-lucide="file-check" className="w-4 h-4 text-gray-300 dark:text-gray-600 group-hover:text-black dark:group-hover:text-white transition-colors"></i>
                                                </div>
                                            </div>
                                        </div>
                                    </motion.div>
                                ))}
                            </motion.div>
                        </AnimatePresence>
                    </div>
                </section>
            );
        };

        // ENHANCED MOMA STYLE ART GALLERY (Asymmetrical Grid & Design Refresh)
        const ArtGallery = () => (
            <section className="py-14 md:py-20 bg-black text-white transition-colors duration-300">
                <div className="max-w-[1600px] mx-auto px-6 lg:px-12">
                    {/* Gallery Header */}
                    <div className="mb-10 md:mb-16 border-t border-white pt-6 flex flex-col md:flex-row justify-between items-start">
                        <div className="md:w-1/3">
                            <h2 className="text-4xl md:text-6xl font-sans font-bold tracking-tighter mb-4">
                                Art & Design<br /><span className="text-moma-red">Gallery</span>
                            </h2>
                        </div>
                        <div className="md:w-1/3">
                            <p className="text-sm md:text-base font-light leading-relaxed text-gray-400">
                                A curated selection of visual works exploring <strong className="text-white">"Altered Landscapes"</strong> and structural transparency.
                                Included in the <span className="text-moma-red font-bold">UNC Studio Art Minor</span> portfolio.
                            </p>
                        </div>
                    </div>

                    {/* MoMA Asymmetrical Grid */}
                    <div className="grid grid-cols-1 md:grid-cols-12 gap-x-6 gap-y-8">
                        {ART_DATA.map((art, i) => (
                            <motion.div
                                key={i}
                                className={`${art.colSpan} flex flex-col gap-3 group`}
                                initial={{ opacity: 0, y: 20 }}
                                whileInView={{ opacity: 1, y: 0 }}
                                viewport={{ once: true, margin: "-10%" }}
                                transition={{ duration: 0.6, delay: i * 0.05 }}
                            >
                                {/* Artwork Frame */}
                                <div className={`w-full ${art.aspect} bg-[#111] relative overflow-hidden shadow-sm group-hover:shadow-xl transition-all duration-500`}>
                                    {art.isPlaceholder ? (
                                        <div className="w-full h-full flex items-center justify-center bg-neutral-900 text-gray-500 font-mono text-xs p-8 text-center">
                                            [ Wide Feature: e.g. Landscape_Compilation.jpg ]
                                        </div>
                                    ) : (
                                        <img
                                            src={art.img}
                                            alt={art.title}
                                            loading="lazy"
                                            className="w-full h-full object-cover transition-transform duration-700 ease-out group-hover:scale-105 group-hover:brightness-110"
                                            onError={(e) => {
                                                e.target.style.display = 'none';
                                                e.target.parentElement.innerHTML = `<div class="w-full h-full flex flex-col items-center justify-center text-gray-400 text-xs font-mono p-4 border border-dashed border-gray-700"><span class="text-2xl mb-2">ðŸ–¼ï¸</span>${art.img}</div>`;
                                            }}
                                        />
                                    )}
                                </div>

                                {/* Museum Label Style Info */}
                                <div className="flex justify-between items-start border-t border-gray-800 pt-2 mt-1 group-hover:border-moma-red transition-colors duration-300">
                                    <div className="max-w-[80%]">
                                        <h4 className="text-lg font-bold leading-tight group-hover:text-moma-red transition-colors">{art.title}</h4>
                                        <p className="text-xs text-gray-500 font-serif italic mt-0.5">{art.medium}</p>
                                    </div>
                                    <span className="text-xs font-mono font-bold text-gray-500 group-hover:text-moma-red transition-colors">
                                        {(i + 1).toString().padStart(2, '0')}
                                    </span>
                                </div>
                            </motion.div>
                        ))}
                    </div>

                    <div className="mt-16 border-b border-white"></div>
                </div>
            </section>
        );

        const UNCSection = () => (
            <section className="bg-white pb-24">
                {/* 1. Hero Banner with Full-Width Blurred Background */}
                <div className="relative w-full h-[95vh] flex items-center justify-center mb-24 overflow-hidden pt-20">
                    <div className="absolute inset-0 z-0 overflow-hidden">
                        {/* Robust Background Fallback */}
                        <img src="UNC_Landscape.jpg" alt="UNC" loading="lazy" className="w-full h-full object-cover object-top blur-md scale-110" onError={(e) => { e.target.style.display = 'none'; }} />
                        <div className="absolute inset-0 bg-gradient-to-b from-white/50 via-unc/10 to-white"></div>
                    </div>
                    <div className="relative z-10 text-center px-6 w-full max-w-4xl mx-auto mt-12">
                        <div className="mb-8 flex justify-center"><div className="w-32 h-32 md:w-40 md:h-40 bg-white rounded-full shadow-2xl border-4 border-white flex items-center justify-center overflow-hidden group cursor-pointer relative hover:scale-105 transition-transform duration-500"><img src="UNC_Logo.png" alt="UNC Logo" loading="lazy" className="w-full h-full object-contain p-4" onError={(e) => { e.target.style.display = 'none'; e.target.parentElement.innerHTML = '<div class="w-full h-full flex items-center justify-center text-unc font-serif font-bold">UNC</div>'; }} /></div></div>
                        <h2 className="text-5xl md:text-8xl font-serif font-bold text-gray-900 mb-6 leading-none tracking-tight drop-shadow-lg">University of North Carolina<br /><span className="text-unc italic relative">at Chapel Hill</span></h2>
                        <p className="text-lg md:text-2xl text-gray-800 font-light max-w-2xl mx-auto leading-relaxed">Ranking No. 1 public university in the South.<br />USNEWS 2024 #22 National University</p>
                    </div>
                </div>

                {/* 2. Bento Grid Layout (Restored) */}
                <div className="max-w-6xl mx-auto px-6">
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                        {/* Card 1: Heritage (Large) */}
                        <div className="md:col-span-2 bg-gray-50 p-8 rounded-xl border border-gray-100 relative overflow-hidden group hover:border-unc/20 transition-colors">
                            <div className="absolute top-0 right-0 w-64 h-64 bg-unc/5 rounded-full mix-blend-multiply filter blur-3xl opacity-50 group-hover:opacity-80 transition-opacity"></div>
                            <div className="relative z-10">
                                <h3 className="text-xl font-bold mb-4 flex items-center gap-2">
                                    <i data-lucide="history" className="w-5 h-5 text-gray-400"></i> Heritage & Story
                                </h3>
                                <p className="text-gray-600 leading-relaxed mb-8 max-w-xl">
                                    Chartered on <strong>December 11, 1789</strong>. The university was founded with a single building called <strong>Old East</strong>. Still used today as a residential building, it is the oldest U.S. public university building.
                                </p>
                                <div className="flex gap-8 md:gap-16 border-t border-gray-200 pt-6">
                                    <div>
                                        <div className="text-4xl font-serif font-bold text-gray-900">1789</div>
                                        <div className="text-xs text-gray-400 uppercase tracking-widest mt-1">Chartered</div>
                                    </div>
                                    <div>
                                        <div className="text-4xl font-serif font-bold text-gray-900">1793</div>
                                        <div className="text-xs text-gray-400 uppercase tracking-widest mt-1">Cornerstone</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* Card 2: Identity (Color) */}
                        <div className="bg-unc text-white p-8 rounded-xl shadow-lg flex flex-col justify-between relative overflow-hidden group">
                            <div className="absolute -bottom-10 -right-10 w-40 h-40 bg-white/10 rounded-full blur-2xl group-hover:scale-110 transition-transform duration-700"></div>
                            <div>
                                <h3 className="text-sm font-bold uppercase tracking-widest opacity-80 mb-2">Identity</h3>
                                <h4 className="text-3xl font-serif font-bold">Carolina Blue</h4>
                            </div>
                            <div className="mt-8">
                                <div className="font-mono text-lg bg-white/20 inline-block px-3 py-1 rounded backdrop-blur-sm border border-white/10">#4B9CD3</div>
                                <p className="text-xs mt-2 opacity-80">Official Web Safe Hex</p>
                            </div>
                        </div>

                        {/* Card 3: Research Stats */}
                        <div className="bg-gray-900 text-white p-8 rounded-xl flex flex-col justify-center border border-gray-800">
                            <i data-lucide="book-open" className="w-8 h-8 text-unc mb-6"></i>
                            <h3 className="text-lg font-bold mb-6">Academic Resources</h3>
                            <div className="space-y-6">
                                <div>
                                    <div className="text-3xl font-mono text-unc font-bold">5.6M+</div>
                                    <div className="text-xs text-gray-400 uppercase tracking-wider mt-1">Library Volumes</div>
                                </div>
                                <div className="h-px bg-gray-800 w-full"></div>
                                <div>
                                    <div className="text-xl font-mono text-white">ibiblio</div>
                                    <div className="text-xs text-gray-400 uppercase tracking-wider mt-1">Digital Collection Hub</div>
                                </div>
                            </div>
                        </div>

                        {/* Card 4: Spirit (Mascot) */}
                        <div className="md:col-span-2 bg-white border border-gray-200 p-8 rounded-xl flex items-center justify-between group hover:border-unc/30 transition-colors hover:shadow-sm">
                            <div>
                                <h3 className="text-xl font-bold mb-2 text-gray-900">Rameses</h3>
                                <p className="text-gray-500 text-sm mb-4 max-w-xs">The Dorset Horn sheep mascot of the North Carolina Tar Heels.</p>
                                <span className="inline-flex items-center gap-1 text-xs font-bold text-unc uppercase tracking-wider group-hover:translate-x-1 transition-transform">
                                    School Spirit <i data-lucide="arrow-right" className="w-3 h-3"></i>
                                </span>
                            </div>
                            <div className="w-24 h-24 bg-gray-50 border border-gray-100 rounded-full flex items-center justify-center text-5xl shadow-inner group-hover:scale-110 transition-transform duration-300">
                                ðŸ
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        );

        // [Rest of the components: Contact, Footer, ChatWidget, App - UNCHANGED]
        const Contact = ({ triggerToast }) => {
            const handleCopy = (e) => { e.preventDefault(); navigator.clipboard.writeText("zhayihan@unc.edu"); triggerToast("Email copied to clipboard!"); };
            const handleSubmit = (e) => { e.preventDefault(); triggerToast("Message sent! I'll get back to you soon."); }
            return (
                <section className="py-16 md:py-32 bg-white dark:bg-gray-900 min-h-screen flex items-center relative overflow-hidden transition-colors duration-300">
                    <div className="absolute inset-0 z-0 overflow-hidden"><img src="UNC_Landscape.jpg" alt="UNC Campus" loading="lazy" className="w-full h-full object-cover object-center blur-sm opacity-20 scale-105" onError={(e) => { e.target.style.display = 'none' }} /><div className="absolute inset-0 bg-white/80 dark:bg-gray-900/90 backdrop-blur-sm"></div></div>
                    <div className="max-w-5xl mx-auto px-6 w-full z-10">
                        <div className="grid md:grid-cols-2 gap-12 md:gap-20">
                            <div><h2 className="text-4xl md:text-7xl font-serif font-bold text-gray-900 dark:text-white mb-6 md:mb-8 leading-none">Let's<br /><span className="text-unc italic">Connect.</span></h2><p className="text-lg md:text-xl text-gray-600 dark:text-gray-300 font-light mb-8 md:mb-12 max-w-sm">Open to PhD opportunities, research collaborations, and technical discussions.</p><div className="space-y-6 md:space-y-8"><div><h3 className="text-xs font-bold text-gray-400 uppercase tracking-widest mb-2">Email</h3><button onClick={handleCopy} className="text-xl md:text-2xl font-mono text-gray-900 dark:text-white hover:text-unc transition-colors border-b border-gray-200 dark:border-gray-700 hover:border-unc pb-1 break-all text-left cursor-pointer">zhayihan@unc.edu</button></div><div><h3 className="text-xs font-bold text-gray-400 uppercase tracking-widest mb-2">Institution</h3><p className="text-base md:text-lg text-gray-800 dark:text-gray-200">University of North Carolina<br />at Chapel Hill</p></div></div></div>
                            <div className="bg-white/90 dark:bg-gray-800/90 p-6 md:p-8 rounded-lg border border-gray-100 dark:border-gray-700 shadow-xl backdrop-blur-md"><h3 className="text-lg font-bold mb-6 text-gray-900 dark:text-white">Send a Message</h3><form className="space-y-4" onSubmit={handleSubmit}><div><label className="block text-xs font-medium text-gray-500 uppercase tracking-wider mb-1">Name</label><input type="text" required className="w-full bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded p-3 focus:outline-none focus:border-unc transition-colors text-gray-900 dark:text-white" placeholder="Your Name" /></div><div><label className="block text-xs font-medium text-gray-500 uppercase tracking-wider mb-1">Email</label><input type="email" required className="w-full bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded p-3 focus:outline-none focus:border-unc transition-colors text-gray-900 dark:text-white" placeholder="your@email.com" /></div><div><label className="block text-xs font-medium text-gray-500 uppercase tracking-wider mb-1">Message</label><textarea rows="4" required className="w-full bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded p-3 focus:outline-none focus:border-unc transition-colors text-gray-900 dark:text-white" placeholder="Hello Yihan..."></textarea></div><button type="submit" className="w-full bg-black dark:bg-white text-white dark:text-black py-3 rounded font-medium hover:bg-unc dark:hover:bg-gray-200 transition-colors flex items-center justify-center gap-2 cursor-pointer shadow-lg hover:shadow-xl transform hover:-translate-y-0.5">Send Message <i data-lucide="send" className="w-4 h-4"></i></button></form></div>
                        </div>
                    </div>
                </section>
            );
        };

        const Footer = ({ activeSection }) => { if (activeSection === 'cv' || activeSection === 'contact') return null; return (<footer className="bg-white dark:bg-gray-900 border-t border-gray-200 dark:border-gray-800 text-black dark:text-white py-24 transition-colors duration-300"><div className="max-w-5xl mx-auto px-6 text-center"><div className="mb-8 flex justify-center text-unc"><i data-lucide="landmark" className="w-8 h-8"></i></div><h2 className="text-3xl md:text-4xl font-serif mb-8 font-bold">Ready to Build.</h2><p className="text-gray-500 dark:text-gray-400 max-w-xl mx-auto mb-12 font-light">School of Information and Library Science (SILS)<br />University of North Carolina at Chapel Hill</p><a href="mailto:zhayihan@unc.edu" className="inline-flex items-center gap-2 bg-black dark:bg-white text-white dark:text-black px-8 py-4 rounded-full font-medium hover:bg-unc dark:hover:bg-gray-200 transition-all cursor-pointer">zhayihan@unc.edu</a></div></footer>); };
        const ChatWidget = () => { const [isOpen, setIsOpen] = useState(false); const [messages, setMessages] = useState([{ role: 'ai', text: "Hi! I'm Yihan's digital assistant. Ask me about his **Research**, **Patents**, or **UNC Background**." }]); const [input, setInput] = useState(''); const [loading, setLoading] = useState(false); const messagesEndRef = useRef(null); useEffect(() => { messagesEndRef.current?.scrollIntoView({ behavior: "smooth" }); }, [messages, isOpen]); const handleSend = async (text = input) => { if (!text.trim()) return; setMessages(prev => [...prev, { role: 'user', text }]); setInput(''); setLoading(true); setTimeout(() => { let aiText = "I'm designed to showcase Yihan's work. Please check the CV for more details."; const q = text.toLowerCase(); if (q.includes('patent')) aiText = "I hold two patents. The primary one is **CN209791046U** (First Inventor)."; else if (q.includes('research')) aiText = "My research proposes an **Intelligent Design Framework** for Urban Micro-Interaction Systems."; setMessages(prev => [...prev, { role: 'ai', text: aiText }]); setLoading(false); }, 800); }; return (<div className="fixed bottom-6 right-6 z-50 font-sans"><AnimatePresence>{isOpen && (<motion.div initial={{ opacity: 0, scale: 0.8, y: 20 }} animate={{ opacity: 1, scale: 1, y: 0 }} exit={{ opacity: 0, scale: 0.8, y: 20 }} className="absolute bottom-20 right-0 w-[300px] bg-white dark:bg-gray-800 rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-700 flex flex-col overflow-hidden h-[450px]"><div className="p-4 bg-gray-50 dark:bg-gray-900 border-b border-gray-100 dark:border-gray-800 flex justify-between items-center"><span className="font-bold text-sm text-gray-900 dark:text-gray-100">AI Assistant</span><button onClick={() => setIsOpen(false)}><i data-lucide="x" className="w-4 h-4 text-gray-400"></i></button></div><div className="flex-1 overflow-y-auto p-4 space-y-4 bg-white dark:bg-gray-800">{messages.map((m, i) => (<div key={i} className={`p-3 rounded-xl text-sm ${m.role === 'ai' ? 'bg-gray-100 dark:bg-gray-700 dark:text-gray-200' : 'bg-unc text-white ml-auto'}`} dangerouslySetInnerHTML={{ __html: marked.parse(m.text) }} />))}<div ref={messagesEndRef} /></div><div className="p-3 border-t border-gray-100 dark:border-gray-700 bg-gray-50 dark:bg-gray-900 flex gap-2"><input value={input} onChange={(e) => setInput(e.target.value)} onKeyDown={(e) => e.key === 'Enter' && handleSend()} placeholder="Type..." className="flex-1 border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-800 dark:text-white rounded-full px-4 py-2 text-sm focus:outline-none focus:border-unc" /><button onClick={() => handleSend()} className="bg-black dark:bg-white text-white dark:text-black p-2 rounded-full"><i data-lucide="arrow-up" className="w-5 h-5"></i></button></div></motion.div>)}</AnimatePresence><motion.button whileHover={{ scale: 1.05 }} whileTap={{ scale: 0.95 }} onClick={() => setIsOpen(!isOpen)} className="bg-black dark:bg-white text-white dark:text-black p-4 rounded-full shadow-2xl hover:shadow-xl transition-all border border-gray-800 cursor-pointer"><i data-lucide={isOpen ? "minus" : "sparkles"} className="w-6 h-6"></i></motion.button></div>); };
        const CVViewer = ({ setActiveSection }) => (<motion.div className="fixed inset-0 z-[100] bg-[#1a1a1a] text-white flex flex-col" initial={{ opacity: 0, y: '100%' }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: '100%' }} transition={{ duration: 0.4, ease: [0.22, 1, 0.36, 1] }}><div className="h-16 bg-black border-b border-gray-800 flex items-center justify-between px-4 md:px-6 flex-shrink-0"><div className="flex items-center gap-4"><button onClick={() => setActiveSection('home')} className="text-gray-400 hover:text-white transition-colors flex items-center gap-2 cursor-pointer"><i data-lucide="arrow-left" className="w-5 h-5"></i> <span className="hidden sm:inline text-sm font-medium">Back</span></button><div className="hidden sm:block h-6 w-px bg-gray-700 mx-2"></div><span className="font-mono text-xs sm:text-sm text-gray-300 truncate max-w-[150px] sm:max-w-none">Yihan Zhang_CV.pdf</span></div><div className="flex items-center gap-3"><a href="04_Yihan Zhang_CV.pdf" download className="bg-unc hover:bg-unc-light text-white px-4 py-2 rounded-full text-sm font-bold transition-all flex items-center gap-2 shadow-lg hover:shadow-unc/20 cursor-pointer"><i data-lucide="download" className="w-4 h-4"></i> <span className="hidden sm:inline">Download</span></a></div></div><div className="flex-grow bg-[#2a2a2a] overflow-hidden relative w-full flex items-center justify-center"><iframe src="04_Yihan Zhang_CV.pdf" className="hidden md:block pdf-frame" title="CV"></iframe><div className="md:hidden flex flex-col items-center justify-center text-center p-8"><i data-lucide="file-text" className="w-16 h-16 text-gray-600 mb-4"></i><h3 className="text-xl font-bold mb-2">View PDF</h3><p className="text-gray-400 mb-6 text-sm">For the best experience on mobile, please open the CV directly.</p><a href="04_Yihan Zhang_CV.pdf" target="_blank" className="bg-white text-black px-6 py-3 rounded-full font-bold cursor-pointer">Tap to Open PDF</a></div></div></motion.div>);

        // --- 3D VISITOR GLOBE COMPONENT ---
        const VisitorGlobe = () => {
            const mountRef = useRef(null);
            const [stats, setStats] = useState({ total: 0, live: 0, top: "Loading..." });
            const [myVisits, setMyVisits] = useState(1);
            const scriptStatus = useScript("https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js");

            // Data Fetching & Interception
            useEffect(() => {
                // Mock jQuery/Zepto if the script relies on it (common in older widgets)
                if (!window.$) {
                    window.$ = (callback) => {
                        if (typeof callback === 'function') callback();
                        return {
                            ready: (cb) => cb && cb(),
                            // Add other dummy methods if needed
                        };
                    };
                    window.jQuery = window.$;
                }

                // Define global callback to intercept data from the JSONP script
                window.addPoints = (points) => {
                    console.log("Visitor Data Intercepted:", points);

                    if (!Array.isArray(points)) {
                        console.warn("Expected array of points, got:", typeof points);
                        return;
                    }

                    // Process stats
                    const totalVisitors = points.reduce((acc, p) => acc + (p.v || 1), 0);
                    // Find top region (simple heuristic: first point or max visitors)
                    const topPoint = points.reduce((prev, current) => ((prev.v || 0) > (current.v || 0)) ? prev : current, points[0] || { name: "Global" });

                    setStats({
                        total: totalVisitors,
                        live: points.length, // Approximate active sessions based on recent points
                        top: topPoint ? topPoint.name : "Global"
                    });

                    // Dispatch event for the 3D scene to pick up
                    const event = new CustomEvent('visitorDataReady', { detail: points });
                    window.dispatchEvent(event);
                };

                // Load the MapMyVisitors script dynamically
                const script = document.createElement('script');
                script.src = "//mapmyvisitors.com/globe_call_home.js?d=WoxzpcNyJItYwn8YpdhfKrREKe55ID9BVs9z5KqcDiI&w=1000"; // Added w param to ensure data
                script.async = true;
                script.onerror = (e) => console.error("Failed to load MapMyVisitors script:", e);
                document.body.appendChild(script);

                return () => {
                    // Cleanup
                    delete window.addPoints;
                    // Only delete $ if we created it
                    // if (window.$ === window.jQuery) delete window.$; 
                    if (script.parentNode) script.parentNode.removeChild(script);
                };
            }, []);

            useEffect(() => {
                if (scriptStatus !== "ready" || !mountRef.current) return;

                // Scene Setup
                const scene = new THREE.Scene();
                const camera = new THREE.PerspectiveCamera(45, mountRef.current.clientWidth / mountRef.current.clientHeight, 0.1, 1000);
                camera.position.z = 2.9; // Zoomed out to fit better (was 1.8)

                const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
                renderer.setSize(mountRef.current.clientWidth, mountRef.current.clientHeight);
                renderer.setPixelRatio(window.devicePixelRatio);
                mountRef.current.appendChild(renderer.domElement);

                // Lighting
                const ambientLight = new THREE.AmbientLight(0xffffff, 0.8);
                scene.add(ambientLight);
                const pointLight = new THREE.PointLight(0xffffff, 0.5);
                pointLight.position.set(5, 3, 5);
                scene.add(pointLight);

                // Globe Geometry (Textured)
                const geometry = new THREE.SphereGeometry(1, 64, 64);
                const textureLoader = new THREE.TextureLoader();
                // Using a reliable dark earth texture
                const texture = textureLoader.load('https://raw.githubusercontent.com/mrdoob/three.js/master/examples/textures/planets/earth_atmos_2048.jpg');

                const material = new THREE.MeshPhongMaterial({
                    map: texture,
                    color: 0xaaaaaa, // Tint to match theme slightly
                    shininess: 5
                });

                const globe = new THREE.Mesh(geometry, material);
                scene.add(globe);

                // Atmosphere Glow (Optional, for aesthetics)
                const atmosphereGeo = new THREE.SphereGeometry(1.1, 64, 64);
                const atmosphereMat = new THREE.MeshBasicMaterial({
                    color: 0x4B9CD3,
                    transparent: true,
                    opacity: 0.1,
                    side: THREE.BackSide
                });
                const atmosphere = new THREE.Mesh(atmosphereGeo, atmosphereMat);
                scene.add(atmosphere);

                // Data Points Group
                const pointsGroup = new THREE.Group();
                globe.add(pointsGroup);

                // Special Marker for Chapel Hill, NC (User Location)
                const myLocation = { lat: 35.9132, lng: -79.0558 };
                const myLocGeo = new THREE.SphereGeometry(0.012, 16, 16); // Smaller size (was 0.025)
                const myLocMat = new THREE.MeshBasicMaterial({ color: 0x00FF00 }); // Green
                const myLocMesh = new THREE.Mesh(myLocGeo, myLocMat);

                // Convert Lat/Lng to 3D Coordinates
                const myPhi = (90 - myLocation.lat) * (Math.PI / 180);
                const myTheta = (myLocation.lng + 180) * (Math.PI / 180);
                const myRadius = 1.02;

                const myX = -(myRadius * Math.sin(myPhi) * Math.cos(myTheta));
                const myZ = (myRadius * Math.sin(myPhi) * Math.sin(myTheta));
                const myY = (myRadius * Math.cos(myPhi));

                myLocMesh.position.set(myX, myY, myZ);
                globe.add(myLocMesh);

                // Function to add points to the globe
                const addGlobePoints = (data) => {
                    // Clear existing points
                    while (pointsGroup.children.length > 0) {
                        pointsGroup.remove(pointsGroup.children[0]);
                    }

                    // Increased point size for better visibility
                    const pointGeo = new THREE.SphereGeometry(0.02, 8, 8);
                    const pointMat = new THREE.MeshBasicMaterial({ color: 0xFFFFFF });

                    // Find my location visits
                    let myCount = 1;
                    data.forEach(p => {
                        // MapMyVisitors uses [lat, lng]
                        const lat = p.latLng[0];
                        const lng = p.latLng[1];

                        // Check if close to my location (within ~0.5 degrees)
                        if (Math.abs(lat - myLocation.lat) < 0.5 && Math.abs(lng - myLocation.lng) < 0.5) {
                            myCount = p.v || 1;
                        }

                        // Convert Lat/Lng to 3D Coordinates
                        const phi = (90 - lat) * (Math.PI / 180);
                        const theta = (lng + 180) * (Math.PI / 180);
                        const radius = 1.02;

                        const x = -(radius * Math.sin(phi) * Math.cos(theta));
                        const z = (radius * Math.sin(phi) * Math.sin(theta));
                        const y = (radius * Math.cos(phi));

                        const point = new THREE.Mesh(pointGeo, pointMat);
                        point.position.set(x, y, z);
                        pointsGroup.add(point);
                    });
                    setMyVisits(myCount);
                };

                // Listen for data
                const handleData = (e) => addGlobePoints(e.detail);
                window.addEventListener('visitorDataReady', handleData);

                // Load OrbitControls and Start Animation
                let controls;
                let animationId;
                const labelDiv = document.getElementById('my-location-label');
                const tempV = new THREE.Vector3();

                // Interaction State
                const raycaster = new THREE.Raycaster();
                const mouse = new THREE.Vector2();
                let isHovering = false;
                let isClicked = false;
                let clickTimeout;

                // Handle Mouse Move for Raycasting
                const onMouseMove = (event) => {
                    if (!mountRef.current) return;
                    const rect = mountRef.current.getBoundingClientRect();
                    mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;
                    mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;
                };

                // Handle Click
                const onClick = (event) => {
                    if (isHovering) {
                        isClicked = true;
                        if (clickTimeout) clearTimeout(clickTimeout);
                        clickTimeout = setTimeout(() => {
                            isClicked = false;
                        }, 2000);
                    }
                };

                mountRef.current.addEventListener('mousemove', onMouseMove);
                mountRef.current.addEventListener('click', onClick);

                const startAnimation = () => {
                    const animate = () => {
                        animationId = requestAnimationFrame(animate);

                        if (controls) {
                            controls.update(); // Required for autoRotate
                        } else {
                            // Fallback rotation if controls not loaded
                            globe.rotation.y += 0.001;
                            if (atmosphere) atmosphere.rotation.y += 0.001;
                        }

                        // Pulse effect for points
                        const time = Date.now() * 0.002;
                        pointsGroup.children.forEach((p, i) => {
                            const scale = 1 + Math.sin(time + i) * 0.3;
                            p.scale.set(scale, scale, scale);
                        });

                        // Raycasting for Hover
                        raycaster.setFromCamera(mouse, camera);
                        const intersects = raycaster.intersectObject(myLocMesh);
                        isHovering = intersects.length > 0;

                        // Update Label Position & Visibility
                        if (labelDiv && myLocMesh) {
                            // Get world position of the marker
                            myLocMesh.getWorldPosition(tempV);

                            // Check if visible (simple dot product check for sphere)
                            // Vector from camera to point
                            const cameraToPoint = new THREE.Vector3().subVectors(tempV, camera.position);
                            // Normal at point (since it's a sphere at 0,0,0, normal is just position normalized)
                            // But simpler: check distance. If point is further than center + radius, it's behind? No.
                            // Dot product of surface normal and camera view vector.
                            // Surface normal at tempV is tempV.clone().normalize().
                            // View vector is cameraToPoint.normalize().
                            // If dot < 0, it's facing the camera.

                            const isNotOccluded = tempV.clone().normalize().dot(cameraToPoint.normalize()) < -0.2; // -0.2 to hide slightly before horizon

                            if (isNotOccluded) {
                                tempV.project(camera);
                                const x = (tempV.x * .5 + .5) * mountRef.current.clientWidth;
                                const y = (tempV.y * -.5 + .5) * mountRef.current.clientHeight;

                                labelDiv.style.transform = `translate(-50%, -100%) translate(${x}px, ${y - 10}px)`;

                                // Visibility Logic: Show if Hovering OR Clicked
                                if (isHovering || isClicked) {
                                    labelDiv.style.opacity = '1';
                                    mountRef.current.style.cursor = 'pointer'; // Change cursor on hover
                                } else {
                                    labelDiv.style.opacity = '0';
                                    mountRef.current.style.cursor = 'move'; // Default cursor
                                }
                            } else {
                                labelDiv.style.opacity = '0';
                            }
                        }

                        renderer.render(scene, camera);
                    };
                    animate();
                };

                // Dynamically load OrbitControls
                const controlsScript = document.createElement('script');
                controlsScript.src = "https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js";
                controlsScript.onload = () => {
                    if (window.THREE && window.THREE.OrbitControls) {
                        controls = new THREE.OrbitControls(camera, renderer.domElement);
                        controls.enableDamping = true;
                        controls.dampingFactor = 0.05;
                        controls.enableZoom = false; // Disable zoom to keep layout stable
                        controls.enablePan = false;
                        controls.autoRotate = true;
                        controls.autoRotateSpeed = 1.0;

                        // Sync atmosphere rotation with globe (if needed, but OrbitControls rotates camera, so objects stay still relative to each other)
                        // Actually, OrbitControls moves the CAMERA. So we don't need to manually rotate the globe mesh anymore.
                        // But we need to make sure the atmosphere is part of the scene (it is).
                    }
                };
                document.body.appendChild(controlsScript);

                startAnimation();

                // Resize Handler
                const handleResize = () => {
                    if (!mountRef.current) return;
                    const width = mountRef.current.clientWidth;
                    const height = mountRef.current.clientHeight;
                    renderer.setSize(width, height);
                    camera.aspect = width / height;
                    camera.updateProjectionMatrix();
                };
                window.addEventListener('resize', handleResize);

                return () => {
                    cancelAnimationFrame(animationId);
                    window.removeEventListener('resize', handleResize);
                    window.removeEventListener('visitorDataReady', handleData);
                    if (mountRef.current) {
                        mountRef.current.removeEventListener('mousemove', onMouseMove);
                        mountRef.current.removeEventListener('click', onClick);
                        if (renderer.domElement && mountRef.current.contains(renderer.domElement)) {
                            mountRef.current.removeChild(renderer.domElement);
                        }
                    }
                    if (clickTimeout) clearTimeout(clickTimeout);
                    if (controlsScript.parentNode) controlsScript.parentNode.removeChild(controlsScript);
                    if (controls) controls.dispose();
                    geometry.dispose();
                    material.dispose();
                    renderer.dispose();
                };
            }, [scriptStatus]);

            return (
                <section className="py-24 bg-black text-white border-t border-gray-900 relative overflow-hidden">
                    <div className="max-w-7xl mx-auto px-6 grid md:grid-cols-2 gap-12 items-center">
                        {/* Left Column: Data & Context */}
                        <div className="space-y-8">
                            <div className="flex items-center gap-3">
                                <span className="relative flex h-3 w-3">
                                    <span className="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span>
                                    <span className="relative inline-flex rounded-full h-3 w-3 bg-green-500"></span>
                                </span>
                                <span className="text-xs font-bold uppercase tracking-widest text-green-400">System Online</span>
                            </div>

                            <div>
                                <h2 className="text-4xl md:text-5xl font-serif font-bold mb-4">Global Reach.</h2>
                                <p className="text-gray-400 text-lg leading-relaxed max-w-md">
                                    Real-time visualization of visitor traffic. Connecting ideas across borders through digital presence.
                                </p>
                            </div>

                            <div className="grid grid-cols-2 gap-6">
                                <div className="p-6 rounded-2xl bg-gray-900/50 border border-gray-800 backdrop-blur-sm">
                                    <div className="text-3xl font-mono font-bold text-white mb-1">{stats.total.toLocaleString()}</div>
                                    <div className="text-xs text-gray-500 uppercase tracking-wider">Total Visits</div>
                                </div>
                                <div className="p-6 rounded-2xl bg-gray-900/50 border border-gray-800 backdrop-blur-sm">
                                    <div className="text-3xl font-mono font-bold text-blue-400 mb-1">{stats.live}</div>
                                    <div className="text-xs text-gray-500 uppercase tracking-wider">Active Now</div>
                                </div>
                                <div className="col-span-2 p-6 rounded-2xl bg-gray-900/50 border border-gray-800 backdrop-blur-sm flex justify-between items-center">
                                    <div>
                                        <div className="text-xl font-bold text-white mb-1">{stats.top}</div>
                                        <div className="text-xs text-gray-500 uppercase tracking-wider">Top Region</div>
                                    </div>
                                    <i data-lucide="globe" className="w-8 h-8 text-gray-700"></i>
                                </div>
                            </div>
                        </div>

                        {/* Right Column: 3D Globe */}
                        <div className="relative h-[500px] w-full flex items-center justify-center rounded-2xl bg-transparent overflow-hidden">
                            {scriptStatus === "ready" ? (
                                <div ref={mountRef} className="w-full h-full absolute inset-0 z-10 cursor-move"></div>
                            ) : (
                                <div className="flex items-center justify-center text-gray-500 text-xs font-mono">Initializing 3D Engine...</div>
                            )}
                            {/* Background Glow for Globe */}
                            <div className="absolute inset-0 bg-blue-500/5 blur-[100px] rounded-full transform scale-75 pointer-events-none"></div>

                            {/* Location Label */}
                            <div id="my-location-label" className="absolute top-0 left-0 z-20 pointer-events-none opacity-0 transition-opacity duration-300 whitespace-nowrap">
                                <div className="flex items-center gap-2 px-3 py-1.5 bg-black/80 backdrop-blur-md border border-gray-700 rounded-lg text-xs text-white shadow-xl transform translate-y-[-10px]">
                                    <span className="text-sm">ðŸ‡ºðŸ‡¸</span>
                                    <span className="font-medium text-gray-300">United States,</span>
                                    <span className="font-bold text-white">Chapel Hill,</span>
                                    <span className="font-mono text-blue-400">{myVisits}</span>
                                </div>
                                {/* Little triangle pointer */}
                                <div className="w-0 h-0 border-l-[6px] border-l-transparent border-r-[6px] border-r-transparent border-t-[6px] border-t-black/80 mx-auto"></div>
                            </div>

                            {/* Legend Overlay */}
                            <div className="absolute bottom-4 right-4 flex gap-4 text-[10px] text-white/40 bg-black/50 px-3 py-1.5 rounded-full backdrop-blur-md border border-white/5 z-20">
                                <span className="flex items-center gap-1.5"><div className="w-1.5 h-1.5 rounded-full bg-white"></div> Visitor</span>
                                <span className="flex items-center gap-1.5"><div className="w-1.5 h-1.5 rounded-full bg-green-500"></div> Live</span>
                            </div>
                        </div>
                    </div>
                </section>
            );
        };

        // --- MAIN APP ---
        const App = () => {
            const [activeSection, setActiveSection] = useState('home');
            const [darkMode, setDarkMode] = useState(() => { const saved = localStorage.getItem('theme'); if (saved) return saved === 'dark'; const h = new Date().getHours(); return h >= 19 || h < 6; });
            const [searchOpen, setSearchOpen] = useState(false);
            const [toast, setToast] = useState({ message: '', isVisible: false });

            useEffect(() => {
                const metaThemeColor = document.querySelector("meta[name=theme-color]");
                if (darkMode) {
                    document.documentElement.classList.add('dark');
                    localStorage.setItem('theme', 'dark');
                    if (metaThemeColor) metaThemeColor.setAttribute("content", "#050505");
                } else {
                    document.documentElement.classList.remove('dark');
                    localStorage.setItem('theme', 'light');
                    if (metaThemeColor) metaThemeColor.setAttribute("content", "#ffffff");
                }
            }, [darkMode]);
            useEffect(() => { const handleK = (e) => { if ((e.metaKey || e.ctrlKey) && e.key === 'k') { e.preventDefault(); setSearchOpen(p => !p); } }; window.addEventListener('keydown', handleK); return () => window.removeEventListener('keydown', handleK); }, []);

            // --- FIXED ICON INITIALIZATION ---
            useEffect(() => {
                if (window.lucide) window.lucide.createIcons();
                const timer = setTimeout(() => {
                    if (window.lucide) window.lucide.createIcons();
                }, 100);
                return () => clearTimeout(timer);
            }, [activeSection, darkMode, searchOpen]);

            const toggleTheme = () => setDarkMode(!darkMode);
            const triggerToast = (msg) => { setToast({ message: msg, isVisible: true }); setTimeout(() => setToast(p => ({ ...p, isVisible: false })), 3000); };

            return (
                <div className="min-h-screen flex flex-col font-sans text-gray-900 dark:text-gray-100 selection:bg-unc/20 selection:text-black dark:selection:text-white transition-colors duration-300">
                    <CustomCursor />
                    <Toast message={toast.message} isVisible={toast.isVisible} />
                    {activeSection !== 'cv' && <Navbar activeSection={activeSection} setActiveSection={setActiveSection} darkMode={darkMode} toggleTheme={toggleTheme} setSearchOpen={setSearchOpen} />}
                    <SearchModal isOpen={searchOpen} onClose={() => setSearchOpen(false)} sections={NAV_ITEMS} activeSection={activeSection} setActiveSection={setActiveSection} />
                    <main className="flex-grow">
                        <AnimatePresence mode="wait">
                            {activeSection === 'home' && (
                                <motion.div key="home" variants={pageVariants} initial="initial" animate="animate" exit="exit">
                                    <Hero setActiveSection={setActiveSection} />
                                    <DeferredSection>
                                        <NewsSection />
                                        <Stats />
                                    </DeferredSection>
                                </motion.div>
                            )}
                            {activeSection === 'now' && <motion.div key="now" variants={pageVariants} initial="initial" animate="animate" exit="exit"><NowPage /></motion.div>}
                            {activeSection === 'news' && <motion.div key="news" variants={pageVariants} initial="initial" animate="animate" exit="exit"><NewsSection /></motion.div>}
                            {activeSection === 'research' && <motion.div key="research" variants={pageVariants} initial="initial" animate="animate" exit="exit"><Research /></motion.div>}
                            {activeSection === 'projects' && <motion.div key="projects" variants={pageVariants} initial="initial" animate="animate" exit="exit"><Projects /></motion.div>}
                            {activeSection === 'unc' && <motion.div key="unc" variants={pageVariants} initial="initial" animate="animate" exit="exit"><UNCSection /></motion.div>}
                            {activeSection === 'art' && <motion.div key="art" variants={pageVariants} initial="initial" animate="animate" exit="exit"><ArtGallery /></motion.div>}
                            {activeSection === 'contact' && <motion.div key="contact" variants={pageVariants} initial="initial" animate="animate" exit="exit"><Contact triggerToast={triggerToast} /></motion.div>}
                            {activeSection === 'cv' && <CVViewer setActiveSection={setActiveSection} />}
                        </AnimatePresence>
                    </main>
                    <Footer activeSection={activeSection} />
                    {activeSection === 'home' && (
                        <DeferredSection>
                            <VisitorGlobe />
                        </DeferredSection>
                    )}
                    {activeSection !== 'cv' && <ChatWidget />}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>